# Cursor数据库搜索功能修复说明

## 问题描述
原版本只搜索C盘的Users目录，导致以下情况下无法找到Cursor数据库：
1. 用户的AppData文件夹在其他盘符
2. 使用了非标准的安装路径
3. 系统配置了自定义用户目录位置

## 修复内容

### 1. 全盘智能搜索
- **扩展搜索范围**：自动检测所有可用驱动器（A-Z盘符）
- **多路径搜索**：同时搜索Roaming和Local的AppData文件夹
- **系统级搜索**：包含Program Files、ProgramData等常见安装位置

### 2. 手动搜索功能
- **用户自定义搜索**：当自动搜索失败时，提供手动指定搜索路径的选项
- **递归搜索**：在指定路径下递归搜索所有state.vscdb文件
- **智能识别**：自动识别找到的数据库文件并提取相关信息

### 3. 改进的用户界面
- **友好的错误提示**：明确说明可能的原因和解决方案
- **手动搜索按钮**：在"未找到数据库"提示框中添加"手动搜索"选项
- **搜索状态反馈**：显示搜索进度和结果

## 搜索覆盖范围

### 自动搜索路径
```
对于每个驱动器 (A: - Z:):
├── X:\Users\[用户名]\AppData\Roaming\Cursor\
├── X:\Users\[用户名]\AppData\Local\Cursor\
├── X:\Cursor\
├── X:\Program Files\Cursor\
├── X:\Program Files (x86)\Cursor\
└── X:\ProgramData\Cursor\
```

### 环境变量路径（降级方案）
```
%APPDATA%\Cursor\
%LOCALAPPDATA%\Cursor\
%USERPROFILE%\AppData\Roaming\Cursor\
```

## 使用方法

### 自动搜索
1. 点击"刷新Cursor"按钮
2. 系统自动在所有驱动器中搜索数据库
3. 如果找到，自动继续续杯流程

### 手动搜索
1. 当出现"未找到Cursor数据库"提示时
2. 点击"手动搜索"按钮
3. 选择要搜索的目录（建议选择用户目录或Cursor安装目录）
4. 系统在指定目录下递归搜索数据库文件
5. 找到后可选择要使用的数据库

## 技术特点

- **智能驱动器检测**：只搜索实际存在的驱动器，避免无效搜索
- **权限容错**：遇到无权限访问的目录会跳过而不会中断搜索
- **性能优化**：限制递归深度，避免过深的目录遍历
- **重复检测**：避免添加重复的数据库路径
- **详细日志**：提供完整的搜索过程日志，便于问题排查

## 兼容性

- **Windows**: 全面支持，包括所有驱动器搜索
- **macOS**: 保持原有搜索逻辑
- **Linux**: 保持原有搜索逻辑

## 解决的场景

1. ✅ AppData在D盘的用户
2. ✅ 使用便携版Cursor的用户  
3. ✅ 自定义安装路径的用户
4. ✅ 多用户共享电脑的情况
5. ✅ 企业环境中的非标准配置

现在用户无论Cursor安装在哪里，都能被准确找到并成功续杯！
